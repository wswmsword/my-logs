# 开发键盘可访问的界面

原文：*https://www.w3.org/WAI/ARIA/apg/practices/keyboard-interface/*

原文日期：无日期

原文作者：[ARIA Authoring Practices Guide (APG)](https://www.w3.org/WAI/ARIA/apg/)

翻译日期：翻译中

## 介绍

对于那些使用 ARIA 保持可访问性的图形用户界面（GUI）组件，开发者必须在代码中提供键盘支持，因为它们不像原生 HTML 表单元素，浏览器不会提供额外的键盘支持。本文会介绍开发包含 ARIA 组件的 web 页面的原则和方法，例如菜单和表格，以及可以通过键盘操作的交互式组件，例如工具栏和对话框。除了焦点管理的基础知识以外，对于以向依赖键盘的人获得和其它人一样有效和愉悦体验为目标，也提供了指导。

本篇文章内容包括：
1. 理解在 ARIA 设计模版里使用的焦点移动约定的基本原则；
2. 维护可见的焦点、可预测的焦点移动，以及区分键盘焦点和选中状态；
3. 管理组件之间的键盘焦点移动，例如，在按下 <kbd>Tab</kbd> 和 <kbd>Shift+Tab</kbd> 的时候焦点如何移动；
4. 在含有多个可聚焦元素的组件内管理键盘焦点的移动，例如，在单选组、菜单、列表框、树和表格之类的组件以编程方式暴露焦点的两种方法；
5. 确定被禁用的可交互元素可以被聚焦的时机；
6. 指定并暴露键盘快捷键，包括关于如何避免和辅助技术、浏览器以及操作系统的快捷键相冲突的一份指导。

## 基本的键盘导航约定

ARIA 角色、状态和属性的可访问性行为和特性，这些在流行的桌面端 GUI 的 GUI 组件之间是共享的，比如微软 Windows、macOS 和 GNOME。同样，ARIA 设计模版借鉴了这些平台的用户期望和键盘约定，为了达到促进贯穿 web 的键盘界面的易于学习和高效操作的目的，持续地集成通用约定。

为了让页面可访问，所有的可交互元素必须能通过键盘操作。另外，在 [APG 模版](https://www.w3.org/WAI/ARIA/apg/patterns/)里描述的通用 GUI 键盘界面约定的一致性运用也是重要的，尤其对于辅助技术用户来说。举个例子，考虑屏幕阅读器用户正在操作一个树形结构，就像熟悉的视觉样式会告诉用户如何通过鼠标展开子树一样，ARIA 属性为用户提供了一个树形结构的声音提示和感受。因此，屏幕阅读器用户通常会期望按下右箭头来展开一个收起的节点。由于屏幕阅读器已经知道元素是树形结构，所以它也会指导新手如何操作这棵树。类似的，语音识别软件也可以实现展开或收起子树的命令，这是因为它能够识别元素是树形结构，并且能够处理类似的键盘命令。所有的这些，会在实现了类似[树形视图模版](https://www.w3.org/WAI/ARIA/apg/patterns/treeview/)所描述的 GUI 键盘约定之后成为现实。

一个在每个平台的通用键盘导航约定是用 <kbd>Tab</kbd> 和 <kbd>Shift+Tab</kbd> 在 UI 组件之间移动，其它还有方向键，会在内部有多个可聚焦元素的组件控制焦点的移动。当按下 <kbd>Tab</kbd> 时，焦点的路径被称为 tab 序列或者 tab 环。

常见的包含多个可聚焦元素的 UI 组件的例子有，单选组、tab 列表、菜单和表格。例如一个单选组，包含多个单选按钮，每一个都是可聚焦的，然而，只有一个单选按钮是在 tab 序列中的。按下 <kbd>Tab</kbd> 之后，焦点移动至单选组的其中一个单选按钮，按下方向键，焦点在焦点组内的每一个焦点按钮上移动，继续按下 <kbd>Tab</kbd>，焦点移出单选组并聚焦 tab 序列的下一个元素。

ARIA 规范把包含多个可聚焦元素的 UI 组件成为一个[复合](https://w3c.github.io/aria/#composite)微件（widget）。在复合微件内部控制焦点移动的过程称为焦点管理。下面是一些包含演示焦点管理的实现范例的 ARIA 设计模版：
- [Combobox](https://www.w3.org/WAI/ARIA/apg/patterns/combobox/)
- [Grid](https://www.w3.org/WAI/ARIA/apg/patterns/grid/)
- [Listbox](https://www.w3.org/WAI/ARIA/apg/patterns/listbox/)
- [Menu and Menubar](https://www.w3.org/WAI/ARIA/apg/patterns/menubar/)
- [Radio Group](https://www.w3.org/WAI/ARIA/apg/patterns/radio/)
- [Tabs](https://www.w3.org/WAI/ARIA/apg/patterns/tabs/)
- [Toolbar](https://www.w3.org/WAI/ARIA/apg/patterns/toolbar/)
- [Treegrid](https://www.w3.org/WAI/ARIA/apg/patterns/treegrid/)
- [Tree View](https://www.w3.org/WAI/ARIA/apg/patterns/treeview/)

## 可辨识和可预测的键盘焦点

跟踪[议题 217](https://github.com/w3c/aria-practices/issues/217) 完成本章节。

在使用键盘的时候，有两个良好体验的基本要素，分别是能够轻松辨识焦点的位置和能够找到按下导航键的下一个聚焦元素。 The following factors affect to what extent a web page affords users these capabilities.
1. 焦点的视觉指示：用户需要能够轻松辨识键盘焦点和其它视觉设计特性。就像鼠标用户会移动鼠标找到指针，键盘用户会按下导航按键来观察移动。如果响应焦点移动的视觉变化是细微的，用户就会失去焦点的跟踪而无法继续操作。我们建议开发者依靠浏览器默认的焦点指示，如果要自定义，需要考虑：
	- 高对比度下，颜色和渐变可能消失；
	- 用户要能轻松区分聚焦和选中，如[聚焦 VS 选中，以及双重聚焦的感知](聚焦-vs-选中，以及双重聚焦的感知)所述，尤其是在组件包含选中的元素而没有焦点的情况；
	- ……等待添加的其他情况……
2. 焦点的持续性：用户界面的总是要有一个组件是活动（document.activeElement 不为空或不为 body 元素）的，并且活动元素有一个视觉的焦点指示。开发者需要管理影响当前活动元素的事件，来保持焦点视觉可见以及移动符合逻辑。举个例子，如果用户关闭对话框或者执行了类似删除列表某项之类的破坏性操作，活动元素可能会被隐藏或者被从 DOM 中移除。如果这样的事件没有管理，没有设置焦点回到那个触发打开对话框或删除列表单项的按钮上，浏览器会将焦点移至 body 元素，会导致用户界面的焦点丢失。
3. 移动可预测：键盘界面的可用性很大程度上由用户能否轻易的猜测焦点在按下导航按键后会聚焦哪里决定。一些增强可预测性的方法包括：
	- 以符合页面语言阅读顺序的模式来移动焦点，例如在从左到右顺序的语言中，创建一个焦点是从左到右、从上到下的序列；
	- 在进入页面的下一部分前，把页面当前部分的元素放入焦点序列。例如有一个多列布局的页面，包含左侧栏、中心区域和右侧栏，在进入中心区域的第一个元素前，建立一个包含左侧栏所有元素的 tab 序列；
	- 当 tab 序列两个连续元素的距离过于遥远的时候，避免移动被当作卡顿、迟缓的问题。举个例子，一个左右顺序语言的页面，要从主要区域右下角的最后一个元素跳到左侧栏的最上面的元素，会有些不可预测，也很难跟上焦点的移动，尤其对于视线狭窄的用户来说更是如此；
	- 让网站保持一致的模式。当相似的页面有相似的焦点移动模式的时候，键盘的体验会更加容易预测；
	- 不要在加载页面后设置初始焦点，除非以下情况：
		- 页面提供了单一的主要的一个功能，几乎所有用户会在页面加载后立即使用该功能；
		- 提供给用户的内容都是页面上的常用功能。

## 聚焦 VS 选中，以及双重聚焦的感知

> to be continued






